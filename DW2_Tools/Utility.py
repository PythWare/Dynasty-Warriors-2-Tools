import os
import tkinter as tk
from tkinter import ttk

class TheCheck:
    @staticmethod
    def validate_numeric_input(new_value):
        return new_value == "" or (new_value.replace(".", "", 1).isdigit() and '.' not in new_value and float(new_value) >= 0)

LILAC = "#C8A2C8"

def setup_lilac_styles():
    style = ttk.Style()
    try:
        style.theme_use("clam")
    except tk.TclError:
        pass
    style.configure("Lilac.TFrame",  background=LILAC)
    style.configure("Lilac.TLabel",  background=LILAC, foreground="black", padding=0)
    style.map("Lilac.TLabel", background=[("active", LILAC)])
    
# This file lives in DW2_Tools
TOOLS_DIR = os.path.dirname(__file__)

# main.pyw lives one level above DW2_Tools
ROOT_DIR = os.path.dirname(TOOLS_DIR)

# DW2.bin sits next to main.pyw
DW2_BIN = os.path.join(ROOT_DIR, "DW2.bin")

# Common subdirectories under DW2_Tools
ICON_DIR = os.path.join(TOOLS_DIR, "Icon_Files")
BACKUP_DIR = os.path.join(TOOLS_DIR, "Backups_For_Mod_Disabling")
MAPS_DIR = os.path.join(TOOLS_DIR, "maps")
BACKGROUNDS_DIR = os.path.join(TOOLS_DIR, "backgrounds")
itemsoffset = 0x160D7E10
unit_data = [0x160A27E8, 0x160A2A8B]
unit_names = [
    "0: Zhao Yun",
    "1: Guan Yu",
    "2: Zhang Fei",
    "3: Xiahou Dun",
    "4: Dian Wei",
    "5: Xu Zhu",
    "6: Zhou Yu",
    "7: Lu Xun",
    "8: Taishi Ci",
    "9: Diao Chan",
    "10: Zhuge Liang",
    "11: Cao Cao",
    "12: Lu Bu",
    "13: Sun Shang Xiang",
    "14: Liu Bei",
    "15: Sun Jian",
    "16: Sun Quan",
    "17: Dong Zhuo",
    "18: Yuan Shao",
    "19: Ma Chao",
    "20: Huang Zhong",
    "21: Xiahou Yuan",
    "22: Zhang Liao",
    "23: Sima Yi",
    "24: Lu Meng",
    "25: Gan Ning",
    "26: Jiang Wei",
    "27: Zhang Jiao",
    "28: Cao Ren",
    "29: Cheng Pu",
    "30: Huang Gai",
    "31: Han Dang",
    "32: Zhang Bao",
    "33: Zhang Liang",
    "34: Zhang Man Cheng",
    "35: Bo Zhang",
    "36: Cao Hong",
    "37: Yan Liang",
    "38: Wen Chou",
    "39: Zhang He",
    "40: Gongsun Zan",
    "41: Hua Xiong",
    "42: Xu Rong",
    "43: Gao Shun",
    "44: Li Ru",
    "45: Li Jue",
    "46: Jia Xu",
    "47: Guo Si",
    "48: Hu Zhen",
    "49: Xu Huang",
    "50: Yu Jin",
    "51: Chun Yuqiong",
    "52: Yue Jin",
    "53: Li Dian",
    "54: Xiahou En",
    "55: Cheng Yu",
    "56: Xun You",
    "57: Zhou Tai",
    "58: Ling Tong",
    "59: Xu Sheng",
    "60: Ding Feng",
    "61: Pang De",
    "62: Huang Quan",
    "63: Guan Xing",
    "64: Zhang Bao",
    "65: Shamoke",
    "66: Deng Ai",
    "67: Zhong Hui",
    "68: Wei Yan",
    "69: Ma Dai",
    "70: Guan Suo",
    "71: Yuan Tan",
    "72: Yuan Xi",
    "73: Yuan Shang",
    "74: Ju Shou",
    "75: Gao Lan",
    "76: Zhao Cen",
    "77: Niou Fu",
    "78: Fan Chou",
    "79: Wang Fang",
    "80: Li Meng",
    "81: He Jin",
    "82: Zhu Yun",
    "83: Lu Zhi",
    "84: Huangfu Song",
    "85: Zhang Chao",
    "86: Liu Yan",
    "87: Zou Ying",
    "88: Cheng Yuanzhi",
    "89: Deng Mao",
    "90: Guan Hai",
    "91: Pei Yuan Shao",
    "92: He Yi",
    "93: Yan Zheng",
    "94: Gao Sheng",
    "95: Liu Yan",
    "96: Song Xian",
    "97: Wei Xu",
    "98: Dong Xi",
    "99: Lu Wei Kuang",
    "100: Xun Chen",
    "101: Han Meng",
    "102: Han Xun",
    "103: Zhou Cang",
    "104: Guan Ping",
    "105: Sun Qian",
    "106: Mi Zhu",
    "107: Mi Fang",
    "108: Liu Feng",
    "109: Chen Dao",
    "110: Liao Hua",
    "111: Liu Qi",
    "112: Cao Pi",
    "113: Cao Zhang",
    "114: Zhu Huan",
    "115: Zhu Ran",
    "116: Jiang Qin",
    "117: Dong Xi",
    "118: Pan Zhang",
    "119: Yan Yan",
    "120: Wu Lan",
    "121: Lei Tong",
    "122: Zhang Ji",
    "123: Zhu Ran",
    "124: Jiang Qin",
    "125: Dong Xi",
    "126: Pan Zhang",
    "127: Yan Yan",
    "128: Private (Wei - sword)",
    "129: Corporal(Sergeant) (Wei - sword)",
    "130: Sergeant(Major) (Wei - sword)",
    "131: Private (Wei - spear)",
    "132: Sergeant (Wei - spear)",
    "133: Major (Wei - spear)",
    "134: Corporal(Private) (Wei - pike)",
    "135: Sergeant (Wei - pike)",
    "136: Major (Wei - pike)",
    "137: Guard (Wei - sword)",
    "138: Guard Captain (Wei - sword)",
    "139: Guard (Wei - spear)",
    "140: Guard Captain (Wei - spear)",
    "141: Guard (Wei - pike)",
    "142: Guard Captain (Wei - pike)",
    "143: Bowman (Wei)",
    "144: First bow (Wei)",
    "145: Crossbow (Wei)",
    "146: First Crossbow (Wei)",
    "147: Gate Guard (Wei)",
    "148: Gate Captain (Wei)",
    "149: Private (Wu - sword)",
    "150: Sergeant (Wu - sword)",
    "151: Major (Wu - sword)",
    "152: Private (Wu - spear)",
    "153: Sergeant (Wu - spear)",
    "154: Major (Wu - spear)",
    "155: Private (Wu - pike)",
    "156: Sergeant (Wu - pike)",
    "157: Major (Wu - pike)",
    "158: Guard (Wu - sword)",
    "159: Guard Captain (Wu - sword)",
    "160: Guard (Wu - spear)",
    "161: Guard Captain (Wu - spear)",
    "162: Guard (Wu - pike)",
    "163: Guard Captain (Wu - pike)",
    "164: Bowman (Wu)",
    "165: First Bow (Wu)",
    "166: Crossbow (Wu)",
    "167: F.Crossbow (Wu)",
    "168: Gate guard (Wu)",
    "169: Gate Captain (Wu)",
    "170: Private (Shu - sword)",
    "171: Sergeant (Shu - sword)",
    "172: Major (Shu - sword)",
    "173: Private (Shu - spear)",
    "174: Sergeant (Shu - spear)",
    "175: Major (Shu - spear)",
    "176: Private (Shu - pike)",
    "177: Sergeant (Shu - pike)",
    "178: Major (Shu - pike)",
    "179: Guard (Shu - sword)",
    "180: Guard Captain (Shu - sword)",
    "181: Guard (Shu - spear)",
    "182: G.Captain (Shu - spear)",
    "183: Guard (Shu - pike)",
    "184: G.Captain (Shu - pike)",
    "185: Bowman (Shu)",
    "186: First Bow (Shu)",
    "187: Crossbow (Shu)",
    "188: First Crossbow (Shu)",
    "189: G.guard (Shu)",
    "190: Gate Captain (Shu)",
    "191: Private (YS - sword)",
    "192: Sergeant (YS - sword)",
    "193: Major (YS - sword)",
    "194: Private (YS - spear)",
    "195: Sergeant (YS - spear)",
    "196: Major (YS - spear)?",
    "197: Private (YS - pike)?",
    "198: Sergeant (YS - pike)?",
    "199: Major (YS - pike)?",
    "200: Guard (YS - sword)",
    "201: G.Captain (YS - sword)",
    "202: Guard (YS - spear)",
    "203: G.Captain (YS - spear)",
    "204: Guard (YS - pike)",
    "205: G.Captain (YS - pike)",
    "206: Bowman (YS)",
    "207: First Bow (YS)",
    "208: Crossbow (YS)",
    "209: Catapult Chief (YS)",
    "210: Gate Guard (YS)",
    "211: G.Captain (YS)",
    "212: Private (Purple - sword)",
    "213: Sergeant (Purple - sword)?",
    "214: Major (Purple - sword)?",
    "215: Private (Purple - spear)?",
    "216: Sergeant (Purple - spear)?",
    "217: Major (Purple - spear)?",
    "218: Private (Purple - pike)?",
    "219: Sergeant (Purple - pike)?",
    "220: Major (Purple - pike)",
    "221: Guard (Purple - sword)",
    "222: G.captain (Purple - sword)",
    "223: Guard (Purple - spear)?",
    "224: G.Captain (Purple - spear)?",
    "225: Guard (Purple - pike)?",
    "226: G.Captain (Purple - pike)",
    "227: Bowman (Purple)",
    "228: First Bow (Purple)?",
    "229: Crossbow (Purple)?",
    "230: First Crossbow (Purple)",
    "231: Gate Guard (Purple)",
    "232: G.Captain (Purple)",
    "233: Trooper (YT - sword)",
    "234: Trooper (YT - spear)",
    "235: Trooper (YT - pike)",
    "236: Captain (YT - sword)",
    "237: Captain (YT - spear)",
    "238: Captain (YT - pike)",
    "239: General (YT - sword)",
    "240: General (YT - spear)",
    "241: General (YT - pike)",
    "242: Bowman (YT)",
    "243: First bow (YT)",
    "244: Bowman (YT)",
    "245: First Bow (YT)",
    "246: Gate guard (YT)",
    "247: Gate Captain (YT)",
    "248: Lady Guard",
    "249: Lady Guard",
    "250: Lady Guard",
    "251: Lady Captain",
    "252: Lady Bowman",
    "253: First Lady Bow",
    "254: Bodyguard",
]
# offsets to obtain stage data
stage_data = [
    [0x24DD6DD8, 0x24DD7708, 0x24DD8038, 0x24DD8968, 0x24DD9298, 0x24DD9BC8, 0x24DDA4F8, 0x24DDAE28],
    [0x24DDF7A8, 0x24DE00D8, 0x24DE0A08, 0x24DE1338, 0x24DE1C68, 0x24DE2598, 0x24DE2EC8, 0x24DE37F8],
    [0x24DE8178, 0x24DE8AA8, 0x24DE93D8, 0x24DE9D08, 0x24DEA638, 0x24DEAF68, 0x24DEB898, 0x24DEC1C8],
    [0x24DF0B48, 0x24DF1478, 0x24DF1DA8, 0x24DF26D8, 0x24DF3008, 0x24DF3938, 0x24DF4268, 0x24DF4B98],
    [0x24DF9518, 0x24DF9E48, 0x24DFA778, 0x24DFB0A8, 0x24DFB9D8, 0x24DFC308, 0x24DFCC38, 0x24DFD568],
    [0x24E01EE8, 0x24E02818, 0x24E03148, 0x24E03A78, 0x24E043A8, 0x24E04CD8, 0x24E05608, 0x24E05F38],
    [0x24E0A8B8, 0x24E0B1E8, 0x24E0BB18, 0x24E0C448, 0x24E0CD78, 0x24E0D6A8, 0x24E0DFD8, 0x24E0E908],
    [0x24E13288, 0x24E13BB8, 0x24E144E8, 0x24E14E18, 0x24E15748, 0x24E16078, 0x24E169A8, 0x24E172D8]
    ] # 8 stages so 8 lists within the main list
